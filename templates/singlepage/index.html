<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <!-- Bootstrap core JS-->
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <meta name="description" content=""/>
    <meta name="author" content=""/>
<!--    현재 로그인한 유저는 user.peson이며 프로필의 소유자는 person으로 알 수 있음
profile은 글 작성자의 프로필을 불러온다-->

    {% if profile.korName %}
    <title>{{ profile.korName }}님의 발자취</title>
    {% else %}
    <title>당신의 프로필을 만들어보세요!</title>
    {% endif %}
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
    <!--    web3 연결, jquery연결-->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.0.0-beta.36/dist/web3.min.js" integrity="sha256-nWBTbvxhJgjslRyuAKJHK+XcZPlCnmIAAMixz6EefVk=" crossorigin="anonymous"></script>

<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
    <!-- Font Awesome icons (free version)-->
    <script src="https://use.fontawesome.com/releases/v5.15.3/js/all.js" crossorigin="anonymous"></script>
    <!-- Google fonts-->
    <link href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed:500,700" rel="stylesheet"
          type="text/css"/>
    <link href="https://fonts.googleapis.com/css?family=Muli:400,400i,800,800i" rel="stylesheet" type="text/css"/>
    <link href="https://fonts.googleapis.com/css?family=Merriweather+Sans:400,700" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic"
          rel="stylesheet" type="text/css"/>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <script src="https://use.fontawesome.com/releases/v5.2.0/js/all.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700&display=swap" rel="stylesheet">
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="{% static 'css/styles.css' %}" rel="stylesheet"/>

    <!--    이미지 변경 팝업 JavaScripts-->
    <script>
        function popup(){
            var url = "https://ipfs.io/ipfs/{{profile.image_hash}}";
            var name = "popup test";
            var option = "width = 500, height = 500, top = 100, left = 200"
            window.open(url, name, option);
        }



    </script>
    <style>
      .spinner {
        animation: spin 2s linear infinite;
      }
      @keyframes spin {
        from {
          transform: rotate(0);
        }
        to {
          transform: rotate(360deg);
        }
      }
    </style>
</head>
<body id="page-top">
<!-- Navigation Start-->
<!--    현재 로그인한 유저는 user.peson이며 프로필의 소유자는 person으로 알 수 있음
profile은 글 작성자의 프로필을 불러온다-->
<nav class="navbar navbar-expand-lg navbar-dark bg-third fixed-top" id="mainNav">
    {% if user.person.pk == person.pk %}
    <a class="navbar-brand js-scroll-trigger" href="#page-top">
    <span class="d-block d-lg-none" style="font-weight:bold; color:white;">{{ profile.korName }}</span>
    {% if profile.image_hash%}
    <span class="d-none d-lg-block">
            <img class="img-fluid img-profile rounded-circle mx-auto mb-2"
                 src="https://ipfs.io/ipfs/{{profile.image_hash}}" onclick="javascript:popup()"/>
    </span>
    {% else %}
    <span class="d-none d-lg-block">
            <img class="img-fluid img-profile rounded-circle mx-auto mb-2"
             src="{% static 'assets/img/face.png' %}" alt="..."/>
    </span>
    {% endif %}
    </a>
    {% else %}
    <div class="navbar-brand js-scroll-trigger">
        {% if profile.korName %}
        <span class="d-block d-lg-none">{{ profile.korName }}님의 발자취</span>
        {% else %}
        <span class="d-block d-lg-none">SEBAKO 가입을 환영합니다!</span>
        {% endif %}
        <span class="d-none d-lg-block">
            {% if profile.image_hash%}
            <img class="img-fluid img-profile rounded-circle mx-auto mb-2"
                 src="https://ipfs.io/ipfs/{{profile.image_hash}}"/></span>
        {% else %}
        <img class="img-fluid img-profile rounded-circle mx-auto mb-2"
             src="{% static 'assets/img/face.png' %}" alt="..."/></span>
        {% endif %}
        {% endif %}
    </div>


    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
            data-target="#navbarResponsive"
            aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation"><span
            class="navbar-toggler-icon"></span></button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav">
            <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#about">About</a></li>
            <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#certificate">Certificate </a></li>
            <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#experience">Experience</a></li>
            <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#education">Education</a></li>
            <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#interests">Interests</a></li>
            <br><br>
            <li class="nav-item"><a style="float:center" class="nav-link" href="{% url 'accounts:logout' %}">로그아웃</a> <a style="float:center"
                                                                                               class="nav-link"
                                                                                               href="/">처음화면</a></li>
        </ul>

    </div>
</nav>
<!-- Page Content-->
<div class="container-fluid p-0">
    <!-- About-->
    <section class="resume-section" id="about">
        <div class="resume-section-content">
<!--            자기소개서를 작성했을 경우 -->
            {% if profile.korName %}
            <h1 class="mb-0" >
                {{ profile.korName }}
                {% if profile.engName %}
                <span class="text-primary">{{ profile.engName }}</span>
                {% endif %}
            </h1>
            <div class="subheading mb-5" style="font-size : 30px">
                {{ profile.address }}  {{ profile.phone }} 
                <a href="mailto:{{profile.email}}" >{{ profile.email }}</a>
            </div>
            <p class="lead mb-5" style="font-family: 'Noto Sans KR', sans-serif; font-weight : 500; font-size : 23px">
                지갑주소 : <a href="https://ropsten.etherscan.io/address/{{person.user}}">{{person.user}}</a> </p>
            <br><br><br>
            <div class="social-icons">
                <!--                        소셜 주소가 있을경우 우리는 github만 사용-->
                {% if profile.insta %}
                <a class="social-icon"  href="{{profile.insta}}"><i class="fab fa-instagram"></i></a>
                {% else %}
                <a class="social-icon disableLink" style="background-color:#E6E6E6;"><i class="fab fa-instagram"></i></a>
                {% endif %}
                {% if profile.github %}
                <a class="social-icon " href="{{profile.github}}"><i class="fab fa-github"></i></a>
                {% else %}
                <a class="social-icon disableLink" style="background-color:#E6E6E6;"><i class="fab fa-github"></i></a>
                {% endif %}
                {% if profile.blog %}
                <a class="social-icon" href="{{profile.blog}}"><i class="fab fa-twitter"></i></a>
                {% else %}
                <a class="social-icon disableLink" style="background-color:#E6E6E6;"><i class="fab fa-twitter"></i></a>
                {% endif %}
                {% if profile.facebook %}
                <a class="social-icon"  href="{{profile.facebook}}"><i class="fab fa-facebook-f"></i></a>
                {% else %}
                <a class="social-icon disableLink" style="background-color:#E6E6E6;"><i class="fab fa-facebook-f"></i></a>
                {% endif %}
            </div>
            <br>
            <br>
            {% if user.person.pk == person.pk %}
            <a type="button" class="btn btn-primary" href="{% url 'singlepage:profile' pk=person.id %}">수정하기</a>
            {% else %}
            {% endif %}

<!--            처음 회원가입했을때 모습을 보여줌-->
            {% else %}
            <h2 class="mb-5" style="font-family: 'Noto Sans KR', sans-serif; font-weight : 700; font-size : 60px; line-height:140%">
                당신은 어떤 사람인가요?<br>
                <span class="text-primary">프로필</span>을 작성해봅시다!😊
            </h2>
            <h4 class="text-secondary" style="font-family: 'Noto Sans KR', sans-serif; font-weight : 700; font-size : 30px; line-height:120%">
                인스타, 깃허브 주소도 함께 등록해보세요<br><br>
            </h4>
            <div class="social-icons">

                <!--                        소셜 주소가 있을경우 우리는 github만 사용-->
                <a class="social-icon disableLink" ><i class="fab fa-instagram"></i></a>
                <a class="social-icon disableLink" ><i class="fab fa-github"></i></a>
                <a class="social-icon disableLink" ><i class="fab fa-twitter"></i></a>
                <a class="social-icon disableLink" ><i class="fab fa-facebook-f"></i></a>
            </div>
            <br>
            <br>
            <br>
            {% if user.person.pk == person.pk %}
            <a type="button" class="btn btn-primary" href="{% url 'singlepage:profile' pk=person.id %}">시작하기</a>
            {% else %}
            {% endif %}

<!--            첫번째 페이즈 끝-->
            {% endif %}




        </div>
    </section>
    <hr class="m-0"/>
    <!--            certificate-->
    <section class="resume-section" id="certificate">
        <div class="resume-section-content">
            <h2 class="mb-5">자격증</h2>
            {% if resume_list %}
            {% for resume in resume_list %}
            <div class="d-flex flex-column flex-md-row justify-content-between mb-5">
                <div class="flex-grow-1">
                    <h3 class="mb-0" style="font-weight:bold;">{{resume.title}}</h3>
                    <div class="subheading mb-3" style="font-weight:bold; margin-top:10px;">{{resume.issure}}</div>

                    <p style="font-weight:bold;">{{resume.regiNum}}</p>
                </div>
                <div class="col-md-2">
                    {% if resume.signature == 'True' %}
                    <img src="https://upload.wikimedia.org/wikipedia/commons/c/c3/Gnome-application-certificate.svg" style="width:auto; height:120px;">
                    {% endif %}
                    {% if resume.signature == 'False' %}
                    <img src="https://cdn.pixabay.com/photo/2020/06/02/12/02/rejected-5250678_960_720.png" style="width:auto; height:120px;">
                    {% endif %}
                    {% if resume.signature == '' %}
                    <i style="margin-top:19px;" class="fas fa-spinner fa-5x spinner"></i>
                    {% endif %}
                </div>
                <div class="flex-shrink-0">
                    <span class="text-primary" style="font-weight:bold">{{resume.dateAcq}}</span><br><br>
                    <p id="resume_id" hidden class="resume_id">{{resume.id}}</p>
<!--                    {% url 'singlepage:delete_resume' person.pk resume.id %}-->
                    <button class="delete{{resume.id}} mb-3 btn btn-primary white" >삭제하기</button>

                    <script>
                        $(document).ready(function(){
                            $(".delete{{resume.id}}").on('click', function() {
                                var conf = confirm("삭제하셔도 블록체인에 기록이 남습니다. \n정말로 삭제하시겠습니까?")
                                if(conf){
                                    location.href = '{% url 'singlepage:delete_resume' person.pk resume.id %}';
                                }
                                else{
                                    location.href;
                                }
                            });
                        });
                    </script>


                </div>



<!--                <div class="flex-shrink-0"><span class="text-primary">{{resume.dateAcq}} - Present</span></div>-->
            </div>
            <hr class="m-0"/>
            {% endfor %}
            {% endif %}
            <div id="certiTable"></div>

            <div class="d-flex flex-column flex-md-row justify-content-between mb-5">
                <div class="flex-grow-1">
                    <h3 class="mb-0" style="font-weight:bold">자격증명</h3>
                    <div class="subheading mb-3" style="font-weight:bold; margin-top:10px;">자격증 발급처</div>
                    <p style="font-weight:bold;">당신의 이력서를 보다 안전하고 편리하게 관리해드립니다</p>
                </div>
                <div class="flex-shrink-0"><span class="text-primary" style="font-weight:bold;">자격증 취득일 20xx-xx</span></div>
            </div>

            <br>
            <br>
            {% if profile.korName %}
            <a type="button" class="btn btn-primary" href="{% url 'singlepage:addRESUME' pk=person.id %}">추가하기</a>
            {% else %}
            <a type="button" class="btn btn-primary" onclick="alert('프로필을 먼저 작성해주세요!!')">추가하기</a>
            {% endif %}
        </div>
    </section>
    <hr class="m-0"/>
    <!-- Experience-->
    <section class="resume-section" id="experience">
        <div class="resume-section-content">
            <h2 class="mb-5">경력</h2>
            {% if experience_list.all %}
            {% for experience in experience_list.all %}
            <div class="d-flex flex-column flex-md-row justify-content-between mb-5">
                <div class="flex-grow-1">
                    <h3 class="mb-0" style="font-weight:bold;">{{experience.company}}</h3>
                    <div class="subheading mb-3" style="font-weight:bold; margin-top:10px;" >{{experience.title}}</div>
                    <p>{{experience.text}}</p>
                </div>
                <div class="col-md-0">
                    {% if experience.signature == 'True' %}
                    <img src="https://upload.wikimedia.org/wikipedia/commons/c/c3/Gnome-application-certificate.svg" style="width:auto; height:120px;">
                    {% endif %}
                    {% if experience.signature == 'False' %}
                    <img src="https://cdn.pixabay.com/photo/2020/06/02/12/02/rejected-5250678_960_720.png" style="width:auto; height:120px;">
                    {% endif %}
                    {% if experience.signature == '' %}
                    <i style="margin-top:19px;" class="fas fa-spinner fa-5x spinner"></i>
                    {% endif %}
                </div>
                <div class="flex-shrink-0"><span style="font-weight:bold;" class="text-primary">{{experience.dateFrom}} - {{experience.dateEnd}}</span><br><br>
                <button class="delete{{experience.id}} mb-3 btn btn-primary white" style="float:right;">삭제하기</button>

                    <script>
                        $(document).ready(function(){
                            $(".delete{{experience.id}}").on('click', function() {
                                var conf = confirm("삭제하셔도 블록체인에 기록이 남습니다. \n정말로 삭제하시겠습니까?")
                                if(conf){
                                    location.href = '{% url 'singlepage:delete_career' pk=person.pk career_id=experience.id %}';
                                }
                                else{
                                    location.href;
                                }
                            });
                        });
                    </script>
                    </div>
            </div>
            <hr class="m-0"/>
            <br><br>
            {% endfor %}
            {% endif %}
            <div id="careeTable"></div>
            <div class="d-flex flex-column flex-md-row justify-content-between mb-5">
                <div class="flex-grow-1">
                    <h5 class="mb-0">※예시입니다※</h5>
                    <h3 class="mb-0">Senior Web Developer</h3>
                    <div class="subheading mb-3">Intelitec Solutions</div>
                    <p>Bring to the table win-win survival strategies to ensure proactive domination. At the end of the
                        day, going forward, a new normal that has evolved from generation X is on the runway heading
                        towards a streamlined cloud solution. User generated content in real-time will have multiple
                        touchpoints for offshoring.</p>
                </div>
                <div class="flex-shrink-0"><span class="text-primary">March 2013 - Present</span></div>
            </div>

            <br>
            <br>
            {% if profile.korName %}
            <a type="button" class="btn btn-primary" href="{% url 'singlepage:addEXPER' pk=person.id %}">추가하기</a>
            {% else %}
            <a type="button" class="btn btn-primary" onclick="alert('프로필을 먼저 작성해주세요!!')">추가하기</a>
            {% endif %}

        </div>
    </section>
    <hr class="m-0"/>
    <!-- Education-->
    <section class="resume-section" id="education">
        <div class="resume-section-content">
            <h2 class="mb-5">학력</h2>
            {% if education_list.all %}
            {% for edu in education_list.all %}
            <div class="d-flex flex-column flex-md-row justify-content-between mb-5">
                <div class="flex-grow-1">
                    <h3 class="mb-0" style="font-weight:bold;">{{edu.school}}</h3>
                    <div class="subheading mb-3" style="font-weight:bold; margin-top:10px;">{{edu.major}}</div>
                    <p style="font-weight:bold;">GPA: {{edu.GPA}}</p>
                </div>
                <div class="col-md-0">
                    {% if edu.signature == 'True' %}
                    <img src="https://upload.wikimedia.org/wikipedia/commons/c/c3/Gnome-application-certificate.svg" style="width:auto; height:120px;">
                    {% endif %}
                    {% if edu.signature == 'False' %}
                    <img src="https://cdn.pixabay.com/photo/2020/06/02/12/02/rejected-5250678_960_720.png" style="width:auto; height:120px;">
                    {% endif %}
                    {% if edu.signature == '' %}
                    <i style="margin-top:19px;" class="fas fa-spinner fa-5x spinner"></i>
                    {% endif %}
                </div>
                <div class="flex-shrink-0"><span style="font-weight:bold;" class="text-primary">{{edu.dateEnd}}</span><br>
                    <button class="delete{{edu.id}} mb-3 btn btn-primary white" style="float:right;">삭제하기</button>

                    <script>
                        $(document).ready(function(){
                            $(".delete{{edu.id}}").on('click', function() {
                                var conf = confirm("삭제하셔도 블록체인에 기록이 남습니다. \n정말로 삭제하시겠습니까?")
                                if(conf){
                                    location.href = '{% url 'singlepage:delete_edu' person.pk edu.id %}';
                                }
                                else{
                                    location.href;
                                }
                            });
                        });
                    </script>
                    </div>
            </div>
            <hr class="m-0"/>
            <br><br>
            {% endfor %}
            {% endif %}
            <div id="eduTable"></div>
            <div class="d-flex flex-column flex-md-row justify-content-between mb-5">
                <div class="flex-grow-1">
                    <h5 class="mb-0">※예시입니다※</h5>
                    <h3 class="mb-0">University of Colorado Boulder</h3>
                    <div class="subheading mb-3">Bachelor of Science</div>
                    <div>Computer Science - Web Development Track</div>
                    <p>GPA: 3.23</p>
                </div>
                <div class="flex-shrink-0"><span class="text-primary">August 2006 - May 2010</span></div>
            </div>
            <br>
            <br>

            {% if profile.korName %}
            <a type="button" class="btn btn-primary" href="{% url 'singlepage:addEDU' pk=person.id %}">추가하기</a>
            {% else %}
            <a type="button" class="btn btn-primary" onclick="alert('프로필을 먼저 작성해주세요!!')">추가하기</a>
            {% endif %}
        </div>
    </section>
    <hr class="m-0"/>

    <!-- Interests-->
    <section class="resume-section" id="interests">
        <div class="resume-section-content">
            <h2 class="mb-5">잡동사니</h2>
            <h4 style="font-weight:bold">방문해주셔서 감사합니다</h4>
            <h4 class="mb-0" style="font-weight:bold">아래 버튼을 눌러 친구에게 송금해보세요!!!🤗</h4>
            <br>
            <br>
            <a type="button" class="btn btn-primary" href="{% url 'singlepage:addIntro' pk=person.id %}">기타기능</a>
        </div>
    </section>
    <hr class="m-0"/>
</div>
<script>
const abi = [
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "previousOwner",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "newOwner",
				"type": "address"
			}
		],
		"name": "OwnershipTransferred",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"internalType": "string",
				"name": "name",
				"type": "string"
			},
			{
				"indexed": false,
				"internalType": "address",
				"name": "cid",
				"type": "address"
			}
		],
		"name": "newCareerCreated",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"internalType": "string",
				"name": "name",
				"type": "string"
			},
			{
				"indexed": false,
				"internalType": "address",
				"name": "pid",
				"type": "address"
			}
		],
		"name": "newCertificationCreated",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"internalType": "string",
				"name": "name",
				"type": "string"
			},
			{
				"indexed": false,
				"internalType": "address",
				"name": "eid",
				"type": "address"
			}
		],
		"name": "newEducationCreated",
		"type": "event"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"name": "careerList",
		"outputs": [
			{
				"internalType": "string",
				"name": "name",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "job",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "compName",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "content",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "startDate",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "endDate",
				"type": "string"
			},
			{
				"internalType": "address",
				"name": "careeID",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "companyAddress",
				"type": "address"
			},
			{
				"internalType": "bool",
				"name": "cidAvailable",
				"type": "bool"
			},
			{
				"internalType": "bool",
				"name": "companySignature",
				"type": "bool"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"name": "certificationList",
		"outputs": [
			{
				"internalType": "string",
				"name": "name",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "certiName",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "certiNumb",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "compName",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "accDate",
				"type": "string"
			},
			{
				"internalType": "address",
				"name": "certiID",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "companyAddress",
				"type": "address"
			},
			{
				"internalType": "bool",
				"name": "pidAvailable",
				"type": "bool"
			},
			{
				"internalType": "bool",
				"name": "companySignature",
				"type": "bool"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "cidCount",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"name": "cidList",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"name": "compAddressList",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "companyCount",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"name": "companyDetailList",
		"outputs": [
			{
				"internalType": "address",
				"name": "compAdress",
				"type": "address"
			},
			{
				"internalType": "string",
				"name": "compName",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"name": "companyList",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "_pid",
				"type": "address"
			}
		],
		"name": "companyRejectCaree",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "_pid",
				"type": "address"
			}
		],
		"name": "companyRejectCerti",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "_pid",
				"type": "address"
			}
		],
		"name": "companyRejectEdu",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "_pid",
				"type": "address"
			}
		],
		"name": "companySignCaree",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "_pid",
				"type": "address"
			}
		],
		"name": "companySignCerti",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "_pid",
				"type": "address"
			}
		],
		"name": "companySignEdu",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"name": "educationList",
		"outputs": [
			{
				"internalType": "string",
				"name": "name",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "schoolName",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "major",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "gpa",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "accDate",
				"type": "string"
			},
			{
				"internalType": "address",
				"name": "eduID",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "companyAddress",
				"type": "address"
			},
			{
				"internalType": "bool",
				"name": "eidAvailable",
				"type": "bool"
			},
			{
				"internalType": "bool",
				"name": "companySignature",
				"type": "bool"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "eidCount",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"name": "eidList",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getBalance",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "owner",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "pidCount",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"name": "pidList",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "renounceOwnership",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "_name",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_job",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_compName",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_content",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_startDate",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_endDate",
				"type": "string"
			}
		],
		"name": "setCareerData",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "_name",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_certiName",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_certiNumb",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_compName",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_accDate",
				"type": "string"
			}
		],
		"name": "setCertificationData",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "_compAddress",
				"type": "address"
			},
			{
				"internalType": "string",
				"name": "_name",
				"type": "string"
			}
		],
		"name": "setCompany",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "_name",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_schoolName",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_major",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_gpa",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_accDate",
				"type": "string"
			}
		],
		"name": "setEducationData",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "newOwner",
				"type": "address"
			}
		],
		"name": "transferOwnership",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	}
]

const address = "0xED111aBCE5A36F48bed94B18a995D78B4069f1b5"
  window.web3 = new Web3(window.ethereum)
  web3 = window.web3
  contract = new web3.eth.Contract(abi,address)
  contract.methods.pidCount.call((err,res)=>{
    if(err){
      return console.log(err)
    }
    else{
      return console.log(res.toString())
    }
  })
function waitForReceipt(hash, cb) {
    web3.eth.getTransactionReceipt(hash, function (err, receipt) {
      if (err) {
        error(err);
      }
      if (receipt !== null) {
        // Transaction went through
        if (cb) {
          cb(receipt);
        }
      } else {
        // Try again in 1 second
        window.setTimeout(function () {
          waitForReceipt(hash, cb);
        }, 1000);
      }
    });
}


window.onload = loadBlockData();
var certificationList = new Array();


function loadBlockData(){

 var certiTable = document.getElementById('certiTable');
 var careeTable = document.getElementById('careeTable');
 var eduTable = document.getElementById('eduTable');


 contract.methods.pidCount().call((err,res)=>{
    if(err){
      return console.log(err)
    }
    else{
      for(var i=1; i<Number(res)+1; i++){

        contract.methods.pidList(i).call((err1,pid)=>{
        if(err1){
          return console.log(err1)
        }
        else{
          // pidList.push(pid);
          contract.methods.certificationList(pid).call((err2,certification)=>{
            if(err2){
              return console.log(err2)
            }
            else{
              if('{{profile.korName}}' != "" && certification[0] === '{{profile.korName}}'){
                console.log(certification);

                if(certification[8] === true ){
                  var row = '<div class="d-flex flex-column flex-md-row justify-content-between mb-5"><div class="flex-grow-1"><h3 class="mb-0" style="font-weight:bold;">' + certification[1] + '</h3><div class="subheading mb-3" style="font-weight:bold; margin-top:10px;">' + certification[3] + '</div><p style="font-weight:bold;">' + certification[2] + '</p></div><div class="col-md-2"><img src="https://upload.wikimedia.org/wikipedia/commons/c/c3/Gnome-application-certificate.svg" style="width:auto; height:120px;"></div><div class="flex-shrink-0"><span class="text-primary" style="font-weight:bold">' + certification[4] + '</span><br><br></div></div><hr class="m-0"/><br><br>'
                  certiTable.innerHTML += row;
                }
                else if(certification[7] === false){
                  var row = '<div class="d-flex flex-column flex-md-row justify-content-between mb-5"><div class="flex-grow-1"><h3 class="mb-0" style="font-weight:bold;">' + certification[1] + '</h3><div class="subheading mb-3" style="font-weight:bold; margin-top:10px;">' + certification[3] + '</div><p style="font-weight:bold;">' + certification[2] + '</p></div><div class="col-md-2"><img src="https://cdn.pixabay.com/photo/2020/06/02/12/02/rejected-5250678_960_720.png" style="width:auto; height:120px;"></div><div class="flex-shrink-0"><span class="text-primary" style="font-weight:bold">' + certification[4] + '</span><br><br></div></div><hr class="m-0"/><br><br>'
                  certiTable.innerHTML += row;
                }
                else if(certification[8] === false){
                  var row = '<div class="d-flex flex-column flex-md-row justify-content-between mb-5"><div class="flex-grow-1"><h3 class="mb-0" style="font-weight:bold;">' + certification[1] + '</h3><div class="subheading mb-3" style="font-weight:bold; margin-top:10px;">' + certification[3] + '</div><p style="font-weight:bold;">' + certification[2] + '</p></div><div class="col-md-2"><i style="margin-top:19px;" class="fas fa-spinner fa-5x spinner"></i></div><div class="flex-shrink-0"><span class="text-primary" style="font-weight:bold">' + certification[4] + '</span><br><br></div></div><hr class="m-0"/><br><br>'
                  certiTable.innerHTML += row;
                }

                // certificationList.push(certification[5]);

              }
            }
          })
        }
      	});
	}
	}
  console.log(certificationList)
  })

  contract.methods.cidCount().call((err,res)=>{
    if(err){
      return console.log(err)
    }
    else{
      for(var i=1; i<Number(res)+1; i++){

        contract.methods.cidList(i).call((err1,cid)=>{
        if(err1){
          return console.log(err1)
        }
        else{
          contract.methods.careerList(cid).call((err2,career)=>{
            if(err2){
              return console.log(err2)
            }
            else{
              if('{{profile.korName}}' != "" && career[0] === '{{profile.korName}}'){
                var row = '<tr><td style="text-align:center; font-weight:bold;">' + career[0] + '</td><td style="text-align:center; font-weight:bold;">' + career[1] + '</td><td style="text-align:center; font-weight:bold;">' + career[2] + '</td><td style="text-align:center; font-weight:bold;">' + career[3] + '</td><td style="text-align:center; font-weight:bold;">' + career[4] + '</td><td align="center"><button class="yes' + career[5] + ' btn btn-primary">YES</button></td><td align="center"><button class="no' + career[5] + ' btn btn-danger">NO</button></td></tr>'
                if(career[9] === true ){
                  var row = '<div class="d-flex flex-column flex-md-row justify-content-between mb-5"><div class="flex-grow-1"><h3 class="mb-0" style="font-weight:bold;">' + career[1] + '</h3><div class="subheading mb-3" style="font-weight:bold; margin-top:10px;" >' + career[2] + '</div><p style="font-weight:bold;">'+ career[3] + '</p></div><div class="col-md-0"><img src="https://upload.wikimedia.org/wikipedia/commons/c/c3/Gnome-application-certificate.svg" style="width:auto; height:120px;"></div><div class="flex-shrink-0"><span style="font-weight:bold;" class="text-primary">' + career[4] + ' - ' + career[5] + '</span><br><br></div></div><hr class="m-0"/><br><br>'
                  careeTable.innerHTML += row;
                }
                else if(career[8] === false){
                  var row = '<div class="d-flex flex-column flex-md-row justify-content-between mb-5"><div class="flex-grow-1"><h3 class="mb-0" style="font-weight:bold;">' + career[1] + '</h3><div class="subheading mb-3" style="font-weight:bold; margin-top:10px;" >' + career[2] + '</div><p style="font-weight:bold;">'+ career[3] + '</p></div><div class="col-md-0"><img src="https://cdn.pixabay.com/photo/2020/06/02/12/02/rejected-5250678_960_720.png" style="width:auto; height:120px;"></div><div class="flex-shrink-0"><span style="font-weight:bold;" class="text-primary">' + career[4] + ' - ' + career[5] + '</span><br><br></div></div><hr class="m-0"/><br><br>'
                  careeTable.innerHTML += row;
                }
                else if(career[9] === false){
                  var row = '<div class="d-flex flex-column flex-md-row justify-content-between mb-5"><div class="flex-grow-1"><h3 class="mb-0" style="font-weight:bold;">' + career[1] + '</h3><div class="subheading mb-3" style="font-weight:bold; margin-top:10px;" >' + career[2] + '</div><p style="font-weight:bold;">'+ career[3] + '</p></div><div class="col-md-0"><i style="margin-top:19px;" class="fas fa-spinner fa-5x spinner"></i></div><div class="flex-shrink-0"><span style="font-weight:bold;" class="text-primary">' + career[4] + ' - ' + career[5] + '</span><br><br></div></div><hr class="m-0"/><br><br>'
                  careeTable.innerHTML += row;
                }

              }
            }
          })
        }
      	});
	}
	}
  })

    contract.methods.eidCount().call((err,res)=>{
    if(err){
      return console.log(err)
    }
    else{
      for(var i=1; i<Number(res)+1; i++){

        contract.methods.eidList(i).call((err1,eid)=>{
        if(err1){
          return console.log(err1)
        }
        else{
          // pidList.push(pid);
          contract.methods.educationList(eid).call((err2,education)=>{
            if(err2){
              return console.log(err2)
            }
            else{
              //console.log(certification[0],certification[1],certification[2]);
              if('{{profile.korName}}' != "" && education[0] === '{{profile.korName}}'){

                if(education[8] === true ){
                  var row = '<div class="d-flex flex-column flex-md-row justify-content-between mb-5"><div class="flex-grow-1"><h3 class="mb-0" style="font-weight:bold;">' + education[1] + '</h3><div class="subheading mb-3" style="font-weight:bold; margin-top:10px;">' + education[2] + '</div><p style="font-weight:bold;">GPA: ' + education[4] +'</p></div><div class="col-md-0"><img src="https://upload.wikimedia.org/wikipedia/commons/c/c3/Gnome-application-certificate.svg" style="width:auto; height:120px;"></div><div class="flex-shrink-0"><span style="font-weight:bold;" class="text-primary">' + education[3] + '</span><br></div></div><hr class="m-0"/><br><br>'
                  eduTable.innerHTML += row;
                }
                else if(education[7] === false){
                  var row = '<div class="d-flex flex-column flex-md-row justify-content-between mb-5"><div class="flex-grow-1"><h3 class="mb-0" style="font-weight:bold;">' + education[1] + '</h3><div class="subheading mb-3" style="font-weight:bold; margin-top:10px;">' + education[2] + '</div><p style="font-weight:bold;">GPA: ' + education[4] +'</p></div><div class="col-md-0"><img src="https://cdn.pixabay.com/photo/2020/06/02/12/02/rejected-5250678_960_720.png" style="width:auto; height:120px;"></div><div class="flex-shrink-0"><span style="font-weight:bold;" class="text-primary">' + education[3] + '</span><br></div></div><hr class="m-0"/><br><br>'
                  eduTable.innerHTML += row;
                }
                else if(education[8] === false){
                  var row = '<div class="d-flex flex-column flex-md-row justify-content-between mb-5"><div class="flex-grow-1"><h3 class="mb-0" style="font-weight:bold;">' + education[1] + '</h3><div class="subheading mb-3" style="font-weight:bold; margin-top:10px;">' + education[2] + '</div><p style="font-weight:bold;">GPA: ' + education[4] +'</p></div><div class="col-md-0"><i style="margin-top:19px;" class="fas fa-spinner fa-5x spinner"></i></div><div class="flex-shrink-0"><span style="font-weight:bold;" class="text-primary">' + education[3] + '</span><br></div></div><hr class="m-0"/><br><br>'
                  eduTable.innerHTML += row;
                }

              }
            }
          })
        }
      	});
	}
	}
  })





}
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- Third party plugin JS-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
<!-- Core theme JS-->
<script src="{% static 'js/scripts.js' %}"></script>
<!--&lt;!&ndash;web3 JS&ndash;&gt;-->
<!--<script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.0.0-beta.36/dist/web3.min.js" integrity="sha256-nWBTbvxhJgjslRyuAKJHK+XcZPlCnmIAAMixz6EefVk=" crossorigin="anonymous"></script>-->
<!--<script src="{% static 'js/web3auth.js' %}"></script>-->
</body>
</html>
